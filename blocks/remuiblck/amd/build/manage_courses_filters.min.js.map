{"version":3,"file":"manage_courses_filters.min.js","sources":["../src/manage_courses_filters.js"],"sourcesContent":["/* eslint-disable no-undef */\ndefine([\n    'jquery',\n    'core/custom_interaction_events',\n    'core/notification',\n    'block_remuiblck/events',\n    'block_remuiblck/manage_courses_view',\n    'core_user/repository'\n], function(\n    $,\n    CustomEvents,\n    Notification,\n    RemuiblckEvents,\n    ManageCoursesView,\n    UserRepository\n) {\n    var SELECTORS = {\n        COURSES_LIST: '[data-region=\"manage-courses-list\"]',\n        DISPLAY_FILTER: '[data-region=\"manage-courses-display-filter\"]',\n        FILTER_OPTION: '[data-value]',\n        PER_PAGE_FILTER: '[data-region=\"per-page-filter\"]',\n        PAGINATE: '[data-action-paginate]',\n        NEXT: '[data-next]',\n        PREVIOUS: '[data-previous]',\n    };\n\n    /**\n     * Event listener for the display selector (\"Card\", \"List\", \"Summary\").\n     *\n     * @param {object} root The root element for the manage courses block\n     */\n    var registerManageCourseDisplayFilter = function(root) {\n        var manageCourseDisplayFilterContainer = $(root).find(SELECTORS.DISPLAY_FILTER);\n        CustomEvents.define(manageCourseDisplayFilterContainer, [CustomEvents.events.activate]);\n        manageCourseDisplayFilterContainer.on(\n            CustomEvents.events.activate,\n            SELECTORS.FILTER_OPTION,\n            function(e, data) {\n                data.originalEvent.preventDefault();\n\n                var option = $(e.target).closest(SELECTORS.FILTER_OPTION);\n\n                // if (option.hasClass('active')) {\n                //     // If it's already active then we don't need to do anything.\n                //     return;\n                // }\n                option.addClass('active');\n                $(e.target).trigger(RemuiblckEvents.MANAGE_COURSES_DISPLAY_FILTER_CHANGE);\n                if ( typeof rmblckmdlrelease !== 'undefined' && rmblckmdlrelease < '4.3' ) {\n                    M.util.set_user_preference('managecourseview', option.data('value'));\n                }else{\n                    UserRepository.setUserPreference('managecourseview', option.data('value'));\n                }\n                ManageCoursesView.loadCourses(\n                    root,\n                    option.data('value'),\n                    getManageCoursesPerPage(root),\n                    $(root).find(SELECTORS.COURSES_LIST).data('currentpage')\n                );\n            }\n        );\n        $(\".display-filter ul li \").on(\"click\", function () {\n            $(this).siblings(\"li\").find(\"a\").removeClass(\"active\");\n            $(this).find(\"a\").addClass(\"active\");\n        });\n    };\n\n    /**\n     * Event listener for the per page selector\n     *\n     * @param {object} root The root element for the manage courses block\n     */\n    var registerManageCoursePerPageFilter = function(root) {\n        var manageCoursePerPageFilterContainer = $(root).find(SELECTORS.PER_PAGE_FILTER);\n        CustomEvents.define(manageCoursePerPageFilterContainer, [CustomEvents.events.activate]);\n        manageCoursePerPageFilterContainer.on(\n            CustomEvents.events.activate,\n            SELECTORS.FILTER_OPTION,\n            function(e, data) {\n                data.originalEvent.preventDefault();\n\n                var option = $(e.target).closest(SELECTORS.FILTER_OPTION);\n\n                if (option.hasClass('active')) {\n                    // If it's already active then we don't need to do anything.\n                    return;\n                }\n\n                $(e.target).trigger(RemuiblckEvents.MANAGE_COURSES_PAGE_FILTER_CHANGE);\n                if ( typeof rmblckmdlrelease !== 'undefined' && rmblckmdlrelease < '4.3' ) {\n                    M.util.set_user_preference('managecourseperpage', option.data('value'));\n                }else{\n                    UserRepository.setUserPreference('managecourseperpage', option.data('value'));\n                }\n                $(root).find(SELECTORS.COURSES_LIST).data('currentpage', 1);\n                ManageCoursesView.loadCourses(\n                    root,\n                    getManageCourseDisplay(root),\n                    option.data('value'),\n                    1\n                );\n            }\n        );\n    };\n\n    /**\n     * Event listener for the pagination controls\n     *\n     * @param {object} root The root element for the manage courses block\n     */\n    var registerManageCoursePageFilter = function(root) {\n        var manageCoursePageFilterContainer = $(root).find(SELECTORS.PAGINATE);\n        manageCoursePageFilterContainer.on(\n            'click',\n            function(e) {\n                var pagenumber = $(root).find(SELECTORS.COURSES_LIST).data('currentpage');\n                var maxpage = $(root).find(SELECTORS.COURSES_LIST).data('totalpages');\n                if ($(this).is(SELECTORS.NEXT)) {\n                    if (pagenumber == maxpage) {\n                        return;\n                    }\n                    pagenumber++;\n                } else if($(this).is(SELECTORS.PREVIOUS)) {\n                    if (pagenumber == 1) {\n                        return;\n                    }\n                    pagenumber--;\n                } else {\n                    return;\n                }\n                $(root).find(SELECTORS.COURSES_LIST).data('currentpage', pagenumber);\n                $(e.target).trigger(RemuiblckEvents.MANAGE_COURSES_PAGINATE);\n                ManageCoursesView.loadCourses(\n                    root,\n                    getManageCourseDisplay(root),\n                    getManageCoursesPerPage(root),\n                    pagenumber\n                );\n            }\n        );\n    };\n\n    /**\n     * Get manage courses display dropdown selection\n     * @param  {DOM}    root block DOM object\n     * @return {string}      selected duration option\n     */\n    var getManageCourseDisplay = function(root) {\n        return $(root).find(SELECTORS.DISPLAY_FILTER).find(SELECTORS.FILTER_OPTION + '.active').data('value');\n    };\n\n    /**\n     * Get manage courses filter dropdown selection\n     * @param  {DOM}    root block DOM object\n     * @return {string}      selected per page courses\n     */\n    var getManageCoursesPerPage = function(root) {\n        return $(root).find(SELECTORS.PER_PAGE_FILTER).find(SELECTORS.FILTER_OPTION + '.active').data('value');\n    };\n\n    /**\n     * Initialise manage courses filters events\n     * @param {DOM} root block DOM object\n     */\n    var init = function(root) {\n        registerManageCourseDisplayFilter(root);\n        registerManageCoursePerPageFilter(root);\n        registerManageCoursePageFilter(root);\n        ManageCoursesView.loadCourses(root, getManageCourseDisplay(root), getManageCoursesPerPage(root));\n    };\n    return {\n        init: init,\n        getManageCourseDisplay: getManageCourseDisplay\n    };\n});\n"],"names":["define","$","CustomEvents","Notification","RemuiblckEvents","ManageCoursesView","UserRepository","SELECTORS","getManageCourseDisplay","root","find","data","getManageCoursesPerPage","init","manageCourseDisplayFilterContainer","events","activate","on","e","originalEvent","preventDefault","option","target","closest","addClass","trigger","MANAGE_COURSES_DISPLAY_FILTER_CHANGE","rmblckmdlrelease","M","util","set_user_preference","setUserPreference","loadCourses","this","siblings","removeClass","registerManageCourseDisplayFilter","manageCoursePerPageFilterContainer","hasClass","MANAGE_COURSES_PAGE_FILTER_CHANGE","registerManageCoursePerPageFilter","pagenumber","maxpage","is","MANAGE_COURSES_PAGINATE","registerManageCoursePageFilter"],"mappings":"AACAA,gDAAO,CACH,SACA,iCACA,oBACA,yBACA,sCACA,yBACD,SACCC,EACAC,aACAC,aACAC,gBACAC,kBACAC,oBAEIC,uBACc,sCADdA,yBAEgB,gDAFhBA,wBAGe,eAHfA,0BAIiB,kCAJjBA,mBAKU,yBALVA,eAMM,cANNA,mBAOU,kBA4HVC,uBAAyB,SAASC,aAC3BR,EAAEQ,MAAMC,KAAKH,0BAA0BG,KAAKH,wBAA0B,WAAWI,KAAK,UAQ7FC,wBAA0B,SAASH,aAC5BR,EAAEQ,MAAMC,KAAKH,2BAA2BG,KAAKH,wBAA0B,WAAWI,KAAK,gBAa3F,CACHE,KAPO,SAASJ,OArIoB,SAASA,UACzCK,mCAAqCb,EAAEQ,MAAMC,KAAKH,0BACtDL,aAAaF,OAAOc,mCAAoC,CAACZ,aAAaa,OAAOC,WAC7EF,mCAAmCG,GAC/Bf,aAAaa,OAAOC,SACpBT,yBACA,SAASW,EAAGP,MACRA,KAAKQ,cAAcC,qBAEfC,OAASpB,EAAEiB,EAAEI,QAAQC,QAAQhB,yBAMjCc,OAAOG,SAAS,UAChBvB,EAAEiB,EAAEI,QAAQG,QAAQrB,gBAAgBsB,sCACH,oBAArBC,kBAAoCA,iBAAmB,MAC/DC,EAAEC,KAAKC,oBAAoB,mBAAoBT,OAAOV,KAAK,UAE3DL,eAAeyB,kBAAkB,mBAAoBV,OAAOV,KAAK,UAErEN,kBAAkB2B,YACdvB,KACAY,OAAOV,KAAK,SACZC,wBAAwBH,MACxBR,EAAEQ,MAAMC,KAAKH,wBAAwBI,KAAK,mBAItDV,EAAE,0BAA0BgB,GAAG,SAAS,WACpChB,EAAEgC,MAAMC,SAAS,MAAMxB,KAAK,KAAKyB,YAAY,UAC7ClC,EAAEgC,MAAMvB,KAAK,KAAKc,SAAS,aAsG/BY,CAAkC3B,MA7FE,SAASA,UACzC4B,mCAAqCpC,EAAEQ,MAAMC,KAAKH,2BACtDL,aAAaF,OAAOqC,mCAAoC,CAACnC,aAAaa,OAAOC,WAC7EqB,mCAAmCpB,GAC/Bf,aAAaa,OAAOC,SACpBT,yBACA,SAASW,EAAGP,MACRA,KAAKQ,cAAcC,qBAEfC,OAASpB,EAAEiB,EAAEI,QAAQC,QAAQhB,yBAE7Bc,OAAOiB,SAAS,YAKpBrC,EAAEiB,EAAEI,QAAQG,QAAQrB,gBAAgBmC,mCACH,oBAArBZ,kBAAoCA,iBAAmB,MAC/DC,EAAEC,KAAKC,oBAAoB,sBAAuBT,OAAOV,KAAK,UAE9DL,eAAeyB,kBAAkB,sBAAuBV,OAAOV,KAAK,UAExEV,EAAEQ,MAAMC,KAAKH,wBAAwBI,KAAK,cAAe,GACzDN,kBAAkB2B,YACdvB,KACAD,uBAAuBC,MACvBY,OAAOV,KAAK,SACZ,OAmEZ6B,CAAkC/B,MAxDD,SAASA,MACJR,EAAEQ,MAAMC,KAAKH,oBACnBU,GAC5B,SACA,SAASC,OACDuB,WAAaxC,EAAEQ,MAAMC,KAAKH,wBAAwBI,KAAK,eACvD+B,QAAUzC,EAAEQ,MAAMC,KAAKH,wBAAwBI,KAAK,iBACpDV,EAAEgC,MAAMU,GAAGpC,gBAAiB,IACxBkC,YAAcC,eAGlBD,iBACG,CAAA,IAAGxC,EAAEgC,MAAMU,GAAGpC,8BACC,GAAdkC,kBAGJA,aAIJxC,EAAEQ,MAAMC,KAAKH,wBAAwBI,KAAK,cAAe8B,YACzDxC,EAAEiB,EAAEI,QAAQG,QAAQrB,gBAAgBwC,yBACpCvC,kBAAkB2B,YACdvB,KACAD,uBAAuBC,MACvBG,wBAAwBH,MACxBgC,eA+BZI,CAA+BpC,MAC/BJ,kBAAkB2B,YAAYvB,KAAMD,uBAAuBC,MAAOG,wBAAwBH,QAI1FD,uBAAwBA"}